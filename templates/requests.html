{% extends "base.html" %}
{% load static %}

{% block title %}({{ count_req }}) Shelby-Test{% endblock title %}

{% block extra_head %}
    <script type="text/javascript" src="{% static 'js/jquery.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/ajax.refresh.js' %}"></script>
    <script type="text/javascript">
        
        function onBlur() {
        	document.body.className = 'blurred';
        	document.getElementById('focus_time').innerHTML = "PAGE WAS BLURRED AT " + Date();
        	var last_req = document.getElementById('myTable').rows[1].cells[0].innerHTML;
        	document.getElementById('last').innerHTML = "LAST REQUEST WAS AT ";
        };
        function onFocus(){
        	document.body.className = 'focused';
        	document.title = "FOCUSED";
        };
        
        if (/*@cc_on!@*/false) { // check for Internet Explorer
        	document.onfocusin = onFocus;
        	document.onfocusout = onBlur;
        } else {
        	window.onfocus = onFocus;
        	window.onblur = onBlur;
        }

    </script>
    
    <style type="text/css">
        .focused #focused, .blurred #blurred, .focus_time, .last { display: inline }
        .focused #blurred, .blurred #focused { display: none }

    </style>
{% endblock extra_head %}

{% block body_class %}focused{% endblock %}

{% block content %}
    <div>
        PAGE IS <span id="focused">FOCUSED</span><span id="blurred">BLURRED</span><br>
        <span id="focus_time"><span><br>
        <span id="last"></span>
    </div>
    <div id="refresh" style="font-family: Georgia,serif;">
    {% if selected_requests %}
        <table id="myTable">
            <tr>
                <th>Time of request</th>
                <th>Method</th>
                <th>Path</th>
                <th>Server Protocol</th>
                <th>Server Address and Port</th>
            </tr>
        
        {% for req in selected_requests %}
            <tr>
                <td id="last_request">{{ req.request_time|date:"d/M/Y H:i:s" }}</td>
                <td>{{ req.method }}</td>
                <td>{{ req.path_info }}</td>
                <td>{{ req.server_protocol }}</td>
                <td>{{ req.remote_address }}:{{ req.server_port }}</td>
            </tr>
        {% endfor %}
        </table>
    {% else %}
        <div class="block3" style="border-top: none;">
        There is no requests generated by you. If you want to see requests you
        need to open some page of this app in new tab.
        </div>
    {% endif %}
    </div>
    <div class="block3" style="border: none;">
		<a href='/'>main page</a>
	</div>
{% endblock content%}